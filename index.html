<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>BeeCaffe&#39;s Personal Blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="BeeCaffe&#39;s Personal Blogs">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="BeeCaffe&#39;s Personal Blogs">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="BeeCaffe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="BeeCaffe&#39;s Personal Blogs" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">BeeCaffe&#39;s Personal Blogs</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-What-Compile-Do-When-An-Empty-Class-Is-Declared" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/15/What-Compile-Do-When-An-Empty-Class-Is-Declared/" class="article-date">
  <time datetime="2020-05-15T14:37:01.000Z" itemprop="datePublished">2020-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/15/What-Compile-Do-When-An-Empty-Class-Is-Declared/">What Compile Do When An Empty Class Is Declared</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li><strong>conclusion</strong>: when an empty class is declared, the compile will generate some members by default.<br>(1) default constructor;<br>(2) copy constructor;<br>(3) operator=();<br>(4) default destructor;</li>
<li><strong>code</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; the mepty class</span><br><span class="line">class Empty&#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;euqal to following</span><br><span class="line">class Empty&#123;</span><br><span class="line">public:</span><br><span class="line">    Empty()&#123;&#125;;</span><br><span class="line">    Empty(const Empty&amp;)&#123;&#125;;</span><br><span class="line">    Empty&amp; operator&#x3D;(const Empty&amp;)&#123;return *this&#125;;</span><br><span class="line">    inline ~Empty()&#123;&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="if-user-declares-a-constructor-the-compile-will-not-generate-default-constructor"><a href="#if-user-declares-a-constructor-the-compile-will-not-generate-default-constructor" class="headerlink" title="if user declares a constructor, the compile will not generate default constructor"></a>if user declares a constructor, the compile will not generate default constructor</h2></li>
<li><strong>explaination</strong>: when a constrcutor is decalred in C++, the compile will not generate default constructor any more. Due to compile regards you do not need a default constructor anymore.</li>
<li><strong>code</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; the mepty class</span><br><span class="line">class Empty&#123;</span><br><span class="line"> public:</span><br><span class="line">    Empty(int val):m_data(val)&#123;&#125;</span><br><span class="line">  private:</span><br><span class="line">    int m_data;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;equals to following</span><br><span class="line">class Empty&#123;</span><br><span class="line">public:</span><br><span class="line">    Empty(int val):m_data(val)&#123;&#125;</span><br><span class="line">    &#x2F;&#x2F;Empty()&#123;&#125;;</span><br><span class="line">    Empty(const Empty&amp;)&#123;&#125;;</span><br><span class="line">    Empty&amp; operator&#x3D;(const Empty&amp;)&#123;return *this&#125;;</span><br><span class="line">    inline ~Empty()&#123;&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/15/What-Compile-Do-When-An-Empty-Class-Is-Declared/" data-id="cka8b3cj6000vokv61ub08uyi" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C++</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Throw-Exception-In-Constructor-And-Destructor" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/15/Throw-Exception-In-Constructor-And-Destructor/" class="article-date">
  <time datetime="2020-05-15T14:35:57.000Z" itemprop="datePublished">2020-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/15/Throw-Exception-In-Constructor-And-Destructor/">Throw Exception In Constructor And Destructor</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="What-will-happen-if-throw-a-exception-in-constructor"><a href="#What-will-happen-if-throw-a-exception-in-constructor" class="headerlink" title="What will happen if throw a exception in constructor?"></a>What will happen if throw a exception in constructor?</h2><ul>
<li><strong>Conculsion</strong>: Throwing an exception in constructor may case two problem:<br>(1) The destructor of this Class can not be called;<br>(2) Memory leaky;</li>
<li><strong>Explain</strong>:<br>As the following code, class ObjectA is a base class which is inherient by class Normal.Meanwhile, there is also another class, class Evil, which has throwed an exception in constructor. Class Normal has a member variable of Class Evil. In the constructor of Class Normal, when the constructor is called, there are four member should be constrcut, their are  m_a,m_evil,m_resource and m_value in Class ObjectA. In Class Normal, m_a,m_resource and m_value have been constructed correctly, however when compile attempts to construct m_evil, there has throwed and exception.It cause the construction of Class Normal has been stopped, thus, Class Normal’s destructor can not be called correctly and m_resource can not be delete. So, there is a memory leaky in this code.</li>
<li><strong>Code</strong>:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">class ObjectA&#123;</span><br><span class="line">    public:</span><br><span class="line">        explicit ObjectA(int a):m_value(new int(a))&#123;&#125;</span><br><span class="line">    private:</span><br><span class="line">        int *m_value;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;Throw a exception in Class Evil</span><br><span class="line">class Evil&#123;</span><br><span class="line">    public:</span><br><span class="line">        Evil()&#123;throw 10;&#125;;</span><br><span class="line">        ~Evil()&#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;destructor can not be called, and m_resource can not be delete, which causes memory leaky.</span><br><span class="line">class Normal:public ObjectA&#123;</span><br><span class="line">    public:</span><br><span class="line">        explicit Normal(int a):ObjectA(a), m_a(a+1),m_resource(new int(a+2))&#123;&#125;</span><br><span class="line">        ~Normal()&#123;delete m_resource;&#125;</span><br><span class="line">    private:</span><br><span class="line">        ObjectA m_a;</span><br><span class="line">        Evil m_evil;</span><br><span class="line">        int *m_resource;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">static void hasMemoryLeak()&#123;</span><br><span class="line">    try&#123;</span><br><span class="line">        Normal n(1);</span><br><span class="line">    &#125;catch(...)&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">    hasMemoryLeak();</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/15/Throw-Exception-In-Constructor-And-Destructor/" data-id="cka8b3ciz000nokv6e6yc7lji" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C++</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-bind-And-function-In-C" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/15/bind-And-function-In-C/" class="article-date">
  <time datetime="2020-05-15T14:34:51.000Z" itemprop="datePublished">2020-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/15/bind-And-function-In-C/">bind And function In C++</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;functional&gt;</span></span></span><br></pre></td></tr></table></figure>
<h2 id="std-function"><a href="#std-function" class="headerlink" title="std::function()"></a>std::function()</h2><p>There are four types callable objects in C++ in total.</p>
<ul>
<li>function</li>
<li>lambda expression</li>
<li>overload operator() class </li>
<li>std::function() object or funtion pointer</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;example of callable object in C++</span><br><span class="line">&#x2F;&#x2F; function</span><br><span class="line">int add(int a, int b)&#123;return a+b;&#125; </span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; lambda expression</span><br><span class="line">auto mod &#x3D; [](int a, int b)&#123; return a % b;&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; calss with overloading operator()</span><br><span class="line">struct divide&#123;</span><br><span class="line">    int operator()(int denominator, int divisor)&#123;</span><br><span class="line">        return denominator&#x2F;divisor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>We can reserve the front callable object in std::funtion(), as following:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::function&lt;<span class="keyword">int</span>(<span class="keyword">int</span> ,<span class="keyword">int</span>)&gt;  a = add; </span><br><span class="line"><span class="built_in">std</span>::function&lt;<span class="keyword">int</span>(<span class="keyword">int</span> ,<span class="keyword">int</span>)&gt;  b = mod ; </span><br><span class="line"><span class="built_in">std</span>::function&lt;<span class="keyword">int</span>(<span class="keyword">int</span> ,<span class="keyword">int</span>)&gt;  c = divide();</span><br></pre></td></tr></table></figure>
<p>Therefore, std::function() is able to save function, lambda expression, function pointer and class with overloading operator(). Generally, std::function() is utilized as callback function to delay the function running time.</p>
<h2 id="std-bind"><a href="#std-bind" class="headerlink" title="std::bind()"></a>std::bind()</h2><p>As we know the function always has arguments list, and std::function is able to bind callable object with arguments. The result of std::bind() is able to save by std::function().</p>
<ul>
<li><strong>bind with function</strong>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::placeholder::_1;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//with out place holder</span></span><br><span class="line"><span class="keyword">auto</span> cb=<span class="built_in">std</span>::bind(sum,<span class="number">21</span>,<span class="number">23</span>);</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;cb()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//with place holder</span></span><br><span class="line"><span class="keyword">auto</span> cb=<span class="built_in">std</span>::bind(sum,<span class="number">21</span>,_1);</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;cb(<span class="number">10</span>)&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>bind arguments to a void() function</strong></p>
<p>  Using std::function() and std::bind(), we can bind any numbers of  arguments with a std::function&lt;void()&gt; functor.</p>
  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::placeholders::_1;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;a+b&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//bind std::function&lt;void(int,int)&gt; to a std::function&lt;void()&gt;</span></span><br><span class="line"><span class="built_in">std</span>::function&lt;<span class="keyword">void</span>()&gt; cb;</span><br><span class="line">cb=<span class="built_in">std</span>::bind(sum,<span class="number">10</span>,<span class="number">12</span>);</span><br><span class="line">cb();</span><br></pre></td></tr></table></figure></li>
<li><p><strong>bind with member function</strong></p>
<p>  If you suppose to bind a member function, you need to bind three parts:</p>
<ul>
<li>Member function reference, e.g. &amp;Sum::sum</li>
<li>Object reference, e.g. &amp;s</li>
<li>arguments.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;functional&gt;</span><br><span class="line">#include&lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">using std::placeholders::_1;</span><br><span class="line">class Sum&#123;</span><br><span class="line">public:</span><br><span class="line">    void sum(int a,int b)&#123;</span><br><span class="line">    cout&lt;&lt;a+b&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">int main()&#123;</span><br><span class="line">    Sum s;</span><br><span class="line">    std::function&lt;void()&gt; cb;</span><br><span class="line">    &#x2F;&#x2F;bind class Sum function sum.</span><br><span class="line">    cb&#x3D;std::bind(&amp;Sum::sum,&amp;s,10,15);</span><br><span class="line">    cb();</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><strong>bind with lambda</strong>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::placeholders::_1;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> lbda=[](<span class="keyword">int</span> a,<span class="keyword">int</span> b)&#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;a+b&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">auto</span> cb = <span class="built_in">std</span>::bind(lbda,<span class="number">12</span>,<span class="number">23</span>);</span><br><span class="line">    cb();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Rerference"><a href="#Rerference" class="headerlink" title="Rerference"></a>Rerference</h2><p>[1] <a href="https://www.jianshu.com/p/f191e88dcc80" target="_blank" rel="noopener">https://www.jianshu.com/p/f191e88dcc80</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/15/bind-And-function-In-C/" data-id="cka8b3cj8000zokv6dk3591fq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C++</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Variable-Arguments-In-C" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/15/Variable-Arguments-In-C/" class="article-date">
  <time datetime="2020-05-15T14:33:34.000Z" itemprop="datePublished">2020-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/15/Variable-Arguments-In-C/">Variable Arguments In C++</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-what-is-variable-arguments"><a href="#1-what-is-variable-arguments" class="headerlink" title="1. what is variable arguments?"></a>1. what is variable arguments?</h2><p>In C\C++ program we always need some functions which arguments number are variable, such as <strong>printf()</strong> and <strong>scanf()</strong>. We called those function as variable arguments function and we use placeholder <strong>…</strong> to represent the uncertained[1]. arguments.</p>
<pre><code>int printf(const char* fmt, ...);
int scanf(const char* fmt, ...);
</code></pre><p>And, there is an simple example of variable arguments:</p>
<pre><code>#include &lt;iostream&gt;
#include &lt;cstdarg&gt;

/*
 * @brief : The purpose of this function is to print any number of integer,
 * @param[in] count : The number of int you suppose to print.
 * @param[in] ... : variable arguments.
 */
int print_args(int count, ...){
    int i,value;
    //// the pointer of arguments address
    va_list arg_ptr;
    //// get address of first argument
    va_start(arg_ptr, count);
    for(int i=0; i&lt;count; ++i){
        //// get the next argument address
        value = va_arg(arg_ptr,int);
        printf(&quot;position %d=%d\n&quot;,i+1,value);
    }
    //// set arg_ptr yo 0
    va_end(arg_ptr);
}

int main() {
    print_args(5,1,2,3,4,5);
    return 0;
}
</code></pre><h2 id="2-The-macros-of-va-list-va-start-va-arg-and-va-end"><a href="#2-The-macros-of-va-list-va-start-va-arg-and-va-end" class="headerlink" title="2. The macros of va_list, va_start, va_arg and va_end"></a>2. The macros of va_list, va_start, va_arg and va_end</h2><p>Those types are used as parameters for the macros defined in <cstdarg> to retrieve the additional arguments of a function[2].</p>
<p><strong>va_list</strong> The type to hold information about variable arguments [2].</p>
<p><strong>va_start(va_list,paramN)</strong> Initialize a variable argument list. Initailizes <strong>va_list</strong> type pointer to retrieve the additional arguments after paramN[2].</p>
<p><strong>va_arg(va_list, type)</strong> Retrieve next argument.</p>
<p><strong>va_end(va_list)</strong> End using variable argument list, set va_list type argument to nullptr.</p>
<p>We can illustrate the upper for loop as the following picture:</p>
<p><img src="https://upload-images.jianshu.io/upload_images/13348038-c8913e90783c0b8f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="va_list.jpg"><br>45B0883250139C6D9A27)</p>
<p>when we call <strong>va_start(arg_ptr,count)</strong>, the arg_ptr has been set to the start address of variable arguments list. Then, the <strong>va_arg(arg_ptr,int)</strong> function move the arg_ptr pointer. In the end, we set arg_ptr to zero.</p>
<h2 id="3-vsprintf-char-str-const-char-format-va-list-arg"><a href="#3-vsprintf-char-str-const-char-format-va-list-arg" class="headerlink" title="3. vsprintf(char str, const char format, va_list arg)"></a>3. vsprintf(char<em> str, const char</em> format, va_list arg)</h2><p>There is a utilization of variable arguments or said va_list, that is function <strong>vsprintf()</strong>, this function is able to print variable arguments in a suitable format.</p>
<p><strong> str </strong> the char* pointer, point to char[] where we suppose to print.</p>
<p><strong>format</strong> the contorl format of string, such as “%d,%f,%n” …</p>
<p><strong>arg</strong> va_list type argument which points to the start position of variable arguments list.</p>
<p>There is a example to utilize va_list and vsprintf()<strong>[3]</strong> :</p>
<pre><code>#include&lt;stdio.h&gt;
#include&lt;stdarg.h&gt;
char buffer[80];
int vspfunc(char* format, ...){
    va_list arg;
    int ans;
    va_start(arg,format);
    ans = vsprintf(buffer,format,arg);
    va_end(arg);
    return ans;
}

int main(){
    int i = 5;
    float f = 27.0;
    char str[50] = &quot;runoob.com&quot;;
    vspfunc(&quot;%d %f %s&quot;,i,f,str);
    printf(&quot;%s\n&quot;,buffer);
    return 0;
}
</code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[1] <a href="https://www.cnblogs.com/zlcxbb/p/6802895.html" target="_blank" rel="noopener">https://www.cnblogs.com/zlcxbb/p/6802895.html</a><br>[2] <a href="http://www.cplusplus.com/reference/cstdarg/va_list/" target="_blank" rel="noopener">http://www.cplusplus.com/reference/cstdarg/va_list/</a><br>[3] <a href="https://www.runoob.com/cprogramming/c-function-vsprintf.html" target="_blank" rel="noopener">https://www.runoob.com/cprogramming/c-function-vsprintf.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/15/Variable-Arguments-In-C/" data-id="cka8b3cj6000wokv6513bc4az" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C++</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Install-Boost-In-Linux" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/15/Install-Boost-In-Linux/" class="article-date">
  <time datetime="2020-05-15T14:32:34.000Z" itemprop="datePublished">2020-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/15/Install-Boost-In-Linux/">Install Boost In Linux</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-Fast-install"><a href="#1-Fast-install" class="headerlink" title="1. Fast install"></a>1. Fast install</h2><p>Typing the following command in linux console to install boost dirtectly.</p>
<p><strong>Notes</strong>: you’d best add <strong>sudo</strong> before you command to aviod premission deny especially in system level path.</p>
<pre><code>wget https://dl.bintray.com/boostorg/release/1.72.0/source/boost_1_72_0.tar.gz

tar -xzvf boost_1_54_0.tar.gz

cd boost_1_54_0

./bootstrap.sh --prefix=/usr/local

./b2 install --with=all

## you can find boost library in /usr/local/lib.
</code></pre><h2 id="2-Test-example"><a href="#2-Test-example" class="headerlink" title="2. Test example"></a>2. Test example</h2><p>There is an test example of boost libray, you just need to copy the soucure code of the following program and compile this source code:</p>
<ul>
<li><p><strong>command</strong></p>
<pre><code>vim boost_test.cc

g++ boost_test.cc -L/usr/local/lib -lboost_system

./a.out
</code></pre></li>
<li><p><strong>source code</strong></p>
<pre><code>#include &lt;boost/lexical_cast.hpp&gt;
#include &lt;iostream&gt;
int main()
{
        using boost::lexical_cast;
        int a = lexical_cast&lt;int&gt;(&quot;123&quot;);
        double b = lexical_cast&lt;double&gt;(&quot;123.12&quot;);
        std::cout&lt;&lt;a&lt;&lt;std::endl;
        std::cout&lt;&lt;b&lt;&lt;std::endl;
        return 0;
}
</code></pre></li>
<li><p><strong>output</strong></p>
<pre><code>123
123.12
</code></pre></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/15/Install-Boost-In-Linux/" data-id="cka8b3cis0005okv62n2c9b82" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-TCP-Three-Way-Handshake" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/15/TCP-Three-Way-Handshake/" class="article-date">
  <time datetime="2020-05-15T14:31:35.000Z" itemprop="datePublished">2020-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/15/TCP-Three-Way-Handshake/">TCP Three Way Handshake</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-TCP-Header-Format"><a href="#1-TCP-Header-Format" class="headerlink" title="1. TCP Header Format"></a>1. TCP Header Format</h2><p>As is shown in the following picture, the TCP header has 20 Bytes in total.</p>
<p><img src="https://upload-images.jianshu.io/upload_images/13348038-e096bec9fa7edcef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li><p><strong>Port Number</strong>: Each TCP segment includes source port number and destination port number, which respectively refers to the TCP segment sender’s and receiver’s address. Notes to mention that, here we utilizes “port” rather than “address”, that is said TCP answer for application layer and itself belong to tranport layer. Meanwhile, the combination of “port” and “IP address” is called socket, which is able to ensure a specific program in a computer. </p>
</li>
<li><p><strong>Sequence Number</strong>: Behind source and destination port, 32 bits have been utilized to reserver sequence number, which is randomlly produced during Three-Way Handshake process and used to ensure the correction of the TCP segment order. TCP is an order protocal, and the sequence number is used to make sure TCP message can be sequential sent to another computer’s application layer.</p>
</li>
<li><strong>Acknowledgement Number</strong>: Then, there is 32 bits Ackknowledgement Number in TCP Header. We call it as ack-number for simplify. Ack-numebr is mainly used to response last received TCP message that your message I have received.</li>
<li>*<em>Header Length</em>: The length of TCP header, usually is 20 Bytes.</li>
<li><strong>Flag Bits</strong>:<ul>
<li><strong>URG=1</strong>: enable Uregent Pointer</li>
<li><strong>ACK=1</strong>: enable Acknowledgement Number </li>
<li><strong>PSH=1</strong>: This message should be submitted to application layer as soon as possible.</li>
<li><strong>RST=1</strong>: reset connection</li>
<li><strong>SYN=1</strong>: open a new connection</li>
<li><strong>FIN=1</strong>: finish a connection</li>
</ul>
</li>
<li><p><strong>CheckSum and Urgent Pinter</strong>:<br><strong>CheckSum</strong> is utilized to check correctness of TCP message to avoid the loss of data in transmission process. In TCP protocol, if transport find that the TCP package in error, it will request the Client/Server resend this package. Urgent pointer, I do not know the usage of this segment.</p>
</li>
<li><p><strong>Notes</strong>:</p>
<ul>
<li>Acknowledge Number(ack) and ACK flag are different things in TCP header.</li>
</ul>
</li>
</ul>
<h2 id="2-Three-Way-Handshake"><a href="#2-Three-Way-Handshake" class="headerlink" title="2. Three-Way Handshake"></a>2. Three-Way Handshake</h2><p>Three-Way Handshake refers to that the client and server link establish process requires three data package in total.This process is generally raised by client function <strong>connect()</strong>, and the mainly process of three way handshake is shown in the following picture.</p>
<p><img src="https://upload-images.jianshu.io/upload_images/13348038-fe57d097a914e27c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li><strong>First-Way Handshake</strong>:<br>Client sets SYN bits as 1, that is SYN=1, and randomly generates a sequence value i, that is seq=i, and sends data package to server. After that client changes state to SYN-SENT and waits for the ackknowledgement of server. Meanwhile, server keeps LISTEN state until the data package come in.</li>
<li><strong>Second-Way Handshake</strong>:<br>Server receive the first package and check the SYN bit. When SYN=1, server knows that client suppose to establish connection with himself. Then the server responds an data package and sets ACK and SYN bit as 1. acknowledgement sequence assigns to i+1, that is ack=i+1, as a respose for first data package. Meanwhile, server also randomly produces a sequence j, that is seq=j, then this package would be send back. After that sever status is setted to SYN-RECV status.</li>
<li><strong>Three-Way Handshake</strong>:<br>When Client receives the package, it will check the acknowledgement sequence’s value and the ACK bit. If ACK=1 and seq=i+1, it will send the last package of the Three-Way Handshake. The ACK bit also is setted as 1 and the seq=j+1, then this package is sent to server by client. Once this package leaves away client, it state is setted as ESTAB-LISHED which represents that the TCP connection has been established successfully. Then, the client and server can tranfer datas each other.<h2 id="3-Four-Way-Wavehand"><a href="#3-Four-Way-Wavehand" class="headerlink" title="3. Four-Way Wavehand"></a>3. Four-Way Wavehand</h2>Four-Way Wavehand refers to that close a TCP connection require four package between client and server in total. The reson why close a TCP connection needs four package is that TCP connection is a Full Duplex data transfers channel. Thus, client and server must close respectively, called half-close, to avoid loss of data.</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/13348038-20a6e02b754a085e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>Duing to TCP connection is full duplex data transfers channel, each channel must be closed one by one to avoid loss of data. For example, when Client hasn’t data to transfrom, the client will send a package with FIN=1 to tell Server that I do not send any package, but I can receive package. After the server receives this package, it will response a package to tell client that I know you will not send package anymore, and keep sending package to client util data finish.</p>
<ul>
<li><strong>One-Way Wavehand</strong>:<br>Client sends a package with FIN=1, seq=i to colse the data send channel, and then Clinet change to FIN-WAIT1 state.</li>
<li><strong>One-Way Wavehand</strong>:<br>After Servre receives the package with FIN=1, it sends a package with ACK=1,seq=i+1 to acknowledge received package, then changes to CLOSE-WAIT state.</li>
<li><p><strong>One-Way Wavehand</strong>:<br>After Servre sends over it’s data, it will send a package with FIN=1, seq=j and changes it state to LAST-ACK.</p>
</li>
<li><p><strong>One-Way Wavehand</strong>:<br>The Client sends the last ACK package to Server, and changes t o TIME-WAIT state, which waits to 2MSL to avoid loss of package. Then Client is closed, and when the servre receive the last ACK package, it will be colsed to.</p>
</li>
<li><p><strong>Notes</strong>:</p>
<ul>
<li><strong>TIME-WAIT</strong>: MSL is the longest time of IP package exists in the internet. As result of routing abnormal, many packages always get loss in internet. And routing abnormal always requires several minute to fix it. During routing abnormal , package may get loss and loop in routes, meanwhile, transmitting end may resend this package, and the lossed package is called lost duplicate or wandering duplicate. TCP protocol must be able to deal wandering duplicate correctly. Therefore, TIME-WAIT state exist in TCP protocol is resonable. Firstly, Reliable implement of TCP full duplex protocol termination. Secondly, Allows duplicate segments to disappear in the network.<h2 id="4-Code-For-Linux"><a href="#4-Code-For-Linux" class="headerlink" title="4. Code For Linux"></a>4. Code For Linux</h2>There is the flow chart of TCP connection and linux code.</li>
</ul>
</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/13348038-ad7f7218e572285e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="cs.jpg"></p>
<pre><code>//Client 
#include&lt;sys/socket.h&gt;
#include&lt;time.h&gt;
#define MAXLEN 1024
int main(int argc,char** argv){
    int sockfd;
    struct sockaddr_in servaddr;
    if(argc!=2)
        err_quit(&quot;usage: tcpli &lt;IP address&gt;&quot;);
    sockfd=socket(AF_INET,SOCK_STREAM,0);
    bzero(&amp;servaddr,sizeof(servaddr));
    servaddr.sin_family = AF_INET;
    servaddr.sin_port=htons(13);
    inet_port(AF_INET,argv[1],&amp;Servaddr.sin_addr);
    connect(sockfd,(SA*)&amp;Servaddr,sizeof(servaddr));
    str_cli(stdin,sockfd);
    return 0;
}

void str_cli(FILE *fp,int sockfd){
    char sendline[MAXLEN],recvline[MAXLEN];
    while(fgets(sendline,MAXLEN,fp)!=NULL){
        write(sockfd,sendline,strlen(sendline));
        if(readline(sockfd,recvline,MAXLEN)==0)
            err_quit(&quot;str_cli:server terminated prematruely&quot;);
        fputs(recvline,stdout);
    }
}

//Server
#include&lt;sys/socket.h&gt;
int main(){
    int listenfd,connfd;
    pid_t child_pid;
    socklen_t clilen;
    struct sockaddr_in cliaddr,servaddr;
    listenfd=socket(AF_INET,SOCK_STREAM,0);
    bzero(&amp;servaddr,sizeof(servaddr));
    servaddr.sin_family = AF_INET;
    servaddr.sin_addr.s_addr=htonl(INADDR_ANY);
    servaddr.sin_port=htons(13);
    bind(listenfd,(SA*)&amp;servaddr,sizeof(servaddr));
    listen(listenfd,LISTENQ);
    for(;;){
        clilen=sizeof(cliaddr);
        connfd=accept(listenfd,(SA*)&amp;cliaddr,&amp;clilen);
        if((chilpid=fork()==0)){
            close(listenfd);
            str_echo(connfd);
            exit(0);
        }
        close(connfd);
    }
    return 0;
}

void str_echo(int sockfd){
    ssize_t n;
    char buf[MAXLEN];
    again:
        while((n=read(sockfd,buf,MAXLEN))&gt;0)
            write(sockfd,buf,n);
        if(n&lt;0&amp;&amp;errno=EINTR)
            goto again;
        else if(n&lt;0)
            err_sys(&quot;str_echo: read error&quot;);
}
</code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[1] <a href="https://www.cnblogs.com/Qing-840/p/9283367.html" target="_blank" rel="noopener">https://www.cnblogs.com/Qing-840/p/9283367.html</a></p>
<p>[2] &lt;&lt;TCP/IP Illustrated, Volume 1: The Protocols&gt;&gt;</p>
<p>[3] &lt;<UNIX network programming>&gt;</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/15/TCP-Three-Way-Handshake/" data-id="cka8b3ciz000lokv64yq83s80" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/network/" rel="tag">network</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-SpinLock-In-Linux" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/15/SpinLock-In-Linux/" class="article-date">
  <time datetime="2020-05-15T14:30:05.000Z" itemprop="datePublished">2020-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/15/SpinLock-In-Linux/">SpinLock In Linux</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="header"><a href="#header" class="headerlink" title="header"></a>header</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;pthread.h&gt;</span></span></span><br></pre></td></tr></table></figure>
<h2 id="category"><a href="#category" class="headerlink" title="category"></a>category</h2><p><a href="#pthread_spinlock_t">pthread_spinlock_t</a></p>
<p><a href="#pthread_spin_init">pthread_spin_init</a></p>
<p><a href="#pthread_spin_destroy">pthread_spin_destroy</a></p>
<p><a href="#pthread_spin_lock">pthread_spin_lock</a></p>
<p><a href="#pthread_spin_trylock">pthread_spin_trylock</a></p>
<p><a href="#pthread_spin_unlock">pthread_spin_unlock</a><br><a href="#code">code</a></p>
<h2 id="pthread-spinlock-t"><a href="#pthread-spinlock-t" class="headerlink" title="pthread_spinlock_t"></a>pthread_spinlock_t</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//initializes method</span></span><br><span class="line"><span class="keyword">pthread_spinlock_t</span> spinlock;</span><br><span class="line">pthread_spin_init(&amp;spinlock,<span class="literal">nullptr</span>);</span><br></pre></td></tr></table></figure>
<h2 id="pthread-spin-init"><a href="#pthread-spin-init" class="headerlink" title="pthread_spin_init"></a>pthread_spin_init</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_spin_init</span><span class="params">(<span class="keyword">pthread_spinlock_t</span> *lock,<span class="keyword">int</span> pshared)</span></span>;</span><br><span class="line">args:</span><br><span class="line">    -lock: the spinlock type in linux</span><br><span class="line">    -pshared: </span><br><span class="line">        -PTHREAD_PROCESS_PRIVATE:spinlock can only be operated by the threads in the same process.</span><br><span class="line">        -PTHREAD_PROCESS_SHARED:spinlock can be operated by any thread in any process.</span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    successed: <span class="number">0</span></span><br><span class="line">    error: Exxx</span><br></pre></td></tr></table></figure>
<h2 id="pthread-spin-destroy"><a href="#pthread-spin-destroy" class="headerlink" title="pthread_spin_destroy"></a>pthread_spin_destroy</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_spin_destroy</span><span class="params">(<span class="keyword">pthread_spinlock_t</span> *lock)</span></span>;</span><br><span class="line">args:</span><br><span class="line">   -lock: the spinlock type in linux</span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">   successed: <span class="number">0</span></span><br><span class="line">   error: Exxx</span><br></pre></td></tr></table></figure>
<h2 id="pthread-spin-lock"><a href="#pthread-spin-lock" class="headerlink" title="pthread_spin_lock"></a>pthread_spin_lock</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_spin_lock</span><span class="params">(<span class="keyword">pthread_spinlock_t</span> *lock)</span></span>;</span><br><span class="line"> args:</span><br><span class="line">    -lock: the spinlock type in linux</span><br><span class="line"> <span class="keyword">return</span>:</span><br><span class="line">    successed: <span class="number">0</span></span><br><span class="line">    error: Exxx</span><br></pre></td></tr></table></figure>
<h2 id="pthread-spin-trylock"><a href="#pthread-spin-trylock" class="headerlink" title="pthread_spin_trylock"></a>pthread_spin_trylock</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_spin_trylock</span><span class="params">(<span class="keyword">pthread_spinlock_t</span> *lock)</span></span></span><br><span class="line"><span class="function"> args:</span></span><br><span class="line">    -lock: the spinlock type in linux</span><br><span class="line"> <span class="keyword">return</span>:</span><br><span class="line">    successed: <span class="number">0</span></span><br><span class="line">    error: Exxx</span><br></pre></td></tr></table></figure>
<h2 id="pthread-spin-unlock"><a href="#pthread-spin-unlock" class="headerlink" title="pthread_spin_unlock"></a>pthread_spin_unlock</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_spin_unlock</span><span class="params">(<span class="keyword">pthread_spinlock_t</span> *lock)</span></span>;</span><br><span class="line">args:</span><br><span class="line">   -lock: the spinlock type in linux</span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">   successed: <span class="number">0</span></span><br><span class="line">   error: Exxx</span><br></pre></td></tr></table></figure>
<h2 id="code"><a href="#code" class="headerlink" title="code"></a>code</h2><hr>
<ul>
<li><p><strong>producer and comsumer model 1: N-1</strong> In this model, we build a class, called CritialZone, where we have a pool to write and read (produce and consume). In this model, we simplely create 10 threads as producer to produce data. After pool is full, we call consumer to read all data in one time.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CriticalZone</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">pthread_spinlock_t</span> s_mutex;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; s_pool;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> s_size;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> s_cur;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> s_val;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">pthread_spinlock_t</span> CriticalZone::s_mutex;</span><br><span class="line"><span class="keyword">int</span> CriticalZone::s_size=<span class="number">1024</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; CriticalZone::s_pool;</span><br><span class="line"><span class="keyword">int</span> CriticalZone::s_cur=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> CriticalZone::s_val=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span>* <span class="title">consumer</span><span class="params">(<span class="keyword">void</span>*)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;CriticalZone::s_size;++i)&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"consuming data: "</span>&lt;&lt;CriticalZone::s_pool[CriticalZone::s_cur]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        CriticalZone::s_cur--;</span><br><span class="line">        CriticalZone::s_pool.pop_back();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span>* <span class="title">producer</span><span class="params">(<span class="keyword">void</span>*)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        pthread_spin_lock(&amp;CriticalZone::s_mutex);</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"thread_"</span>&lt;&lt;pthread_self()&lt;&lt;<span class="string">" is writing value:"</span>&lt;&lt;CriticalZone::s_val&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">if</span>(CriticalZone::s_cur&gt;=CriticalZone::s_size)&#123;</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;<span class="string">"pool is full"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">            pthread_spin_unlock(&amp;CriticalZone::s_mutex);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        CriticalZone::s_pool.push_back(CriticalZone::s_val);</span><br><span class="line">        CriticalZone::s_val++;</span><br><span class="line">        CriticalZone::s_cur++;</span><br><span class="line">        pthread_spin_unlock(&amp;CriticalZone::s_mutex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">pthread_t</span>&gt; <span class="title">tids</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    pthread_spin_init(&amp;CriticalZone::s_mutex,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(pthread_create(&amp;tids[i],<span class="literal">nullptr</span>,producer,<span class="literal">nullptr</span>))&#123;</span><br><span class="line">            assert(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(pthread_join(tids[i],<span class="literal">nullptr</span>))&#123;</span><br><span class="line">            assert(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">pthread_t</span> tid;</span><br><span class="line">    <span class="keyword">if</span>(pthread_create(&amp;tid,<span class="literal">nullptr</span>,consumer,<span class="literal">nullptr</span>))&#123;</span><br><span class="line">        assert(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(pthread_join(tid,<span class="literal">nullptr</span>))&#123;</span><br><span class="line">        assert(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"main end!"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>producer and consumer model 2: N-1</strong> In this model, we create 10 threads to write and one threads to read. When there is no data in the pool, the consumer should recurrently wait for the data, util the pool is not empty.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CriticalZone</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">pthread_spinlock_t</span> s_mutex;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; s_pool;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> s_size;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> s_cur;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> s_val;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">pthread_spinlock_t</span> CriticalZone::s_mutex;</span><br><span class="line"><span class="keyword">int</span> CriticalZone::s_size=<span class="number">1024</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; CriticalZone::s_pool;</span><br><span class="line"><span class="keyword">int</span> CriticalZone::s_cur=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> CriticalZone::s_val=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">consume_wait</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        pthread_spin_lock(&amp;CriticalZone::s_mutex);</span><br><span class="line">        <span class="keyword">if</span>(i&lt;CriticalZone::s_cur)&#123;</span><br><span class="line">            pthread_spin_unlock(&amp;CriticalZone::s_mutex);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        pthread_spin_unlock(&amp;CriticalZone::s_mutex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span>* <span class="title">consumer</span><span class="params">(<span class="keyword">void</span>*)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;CriticalZone::s_size;++i)&#123;</span><br><span class="line">        consume_wait(i);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"consuming data: "</span>&lt;&lt;i&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span>* <span class="title">producer</span><span class="params">(<span class="keyword">void</span>*)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        pthread_spin_lock(&amp;CriticalZone::s_mutex);</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"thread_"</span>&lt;&lt;pthread_self()&lt;&lt;<span class="string">" is writing value:"</span>&lt;&lt;CriticalZone::s_val&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">if</span>(CriticalZone::s_cur&gt;=CriticalZone::s_size)&#123;</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;<span class="string">"pool is full"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">            pthread_spin_unlock(&amp;CriticalZone::s_mutex);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        CriticalZone::s_pool.push_back(CriticalZone::s_val);</span><br><span class="line">        CriticalZone::s_val++;</span><br><span class="line">        CriticalZone::s_cur++;</span><br><span class="line">        pthread_spin_unlock(&amp;CriticalZone::s_mutex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">pthread_t</span>&gt; <span class="title">tids</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    pthread_spin_init(&amp;CriticalZone::s_mutex,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(pthread_create(&amp;tids[i],<span class="literal">nullptr</span>,producer,<span class="literal">nullptr</span>))&#123;</span><br><span class="line">            assert(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">pthread_t</span> tid;</span><br><span class="line">    <span class="keyword">if</span>(pthread_create(&amp;tid,<span class="literal">nullptr</span>,consumer,<span class="literal">nullptr</span>))&#123;</span><br><span class="line">        assert(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(pthread_join(tids[i],<span class="literal">nullptr</span>))&#123;</span><br><span class="line">            assert(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(pthread_join(tid,<span class="literal">nullptr</span>))&#123;</span><br><span class="line">        assert(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"main end!"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><strong>producer and consumer model 3: N-N</strong> In this model, we create 10 threads to write and 10 threads to read. when and only when, there are on writers or readers writing or reading writer and reader can write and read. That is to say, lock is monopolized by one object.<pre><code class="cc">
</code></pre>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/15/SpinLock-In-Linux/" data-id="cka8b3cix000hokv60hudas0y" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Fiber-In-Linux" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/15/Fiber-In-Linux/" class="article-date">
  <time datetime="2020-05-15T14:29:20.000Z" itemprop="datePublished">2020-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/15/Fiber-In-Linux/">Fiber In Linux</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Coroutines are computer program components that generalize subroutines for non-preemptive multitasking, by allowing execution to be suspended and resumed. Coroutines are well-suited for implementing familiar program components such as cooperative tasks, exceptions, event loops, iterators, infinite lists and pipes.</p>
<p>Coroutines are very similar to threads. However, coroutines are cooperatively multitasked, whereas threads are typically preemptively multitasked. This means that coroutines provide concurrency but not parallelism. The advantages of coroutines over threads are that they may be used in a hard-realtime context (switching between coroutines need not involve any system calls or any blocking calls whatsoever), there is no need for synchronisation primitives such as mutexes, semaphores, etc. in order to guard critical sections, and there is no need for support from the operating system.</p>
<p>It is possible to implement coroutines using preemptively-scheduled threads, in a way that will be transparent to the calling code, but some of the advantages (particularly the suitability for hard-realtime operation and relative cheapness of switching between them) will be lost [1].</p>
<p>In this blog, we will introduce the Linux library “ucontext.h” and use it to implement a simple coroutines program.</p>
<h2 id="header"><a href="#header" class="headerlink" title="header"></a>header</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ucontext.h&gt;</span></span></span><br></pre></td></tr></table></figure>
<h2 id="category"><a href="#category" class="headerlink" title="category"></a>category</h2><hr>
<ul>
<li><a href="#ucontext_t">ucontext_t</a></li>
</ul>
<!--[mcontext_t](#mcontext_t)-->
<ul>
<li><p><a href="#getcontext">getcontext</a></p>
</li>
<li><p><a href="#setcontext">setcontext</a></p>
</li>
<li><p><a href="#makecontext">makcontext</a></p>
</li>
<li><p><a href="#swapcontext">swapcontext</a></p>
</li>
<li><a href="#code">code</a></li>
</ul>
<h2 id="ucontext-t"><a href="#ucontext-t" class="headerlink" title="ucontext_t"></a>ucontext_t</h2><hr>
<p>The  mcontext_t  type  is  machine-dependent and opaque.  The<br>ucontext_t type is a structure that has at least the following fields:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">ucontext_t</span> &#123;</span></span><br><span class="line">            <span class="comment">//points to the context that will be resumed  when  thecurrent  context  terminates</span></span><br><span class="line">           <span class="class"><span class="keyword">struct</span> <span class="title">ucontext_t</span> *<span class="title">uc_link</span>;</span>  </span><br><span class="line">           <span class="comment">// the set of  signals  blocked  in this context</span></span><br><span class="line">           <span class="keyword">sigset_t</span>          uc_sigmask;</span><br><span class="line">           <span class="comment">//the stack used by this context</span></span><br><span class="line">           <span class="keyword">stack_t</span>           uc_stack;</span><br><span class="line">           <span class="comment">//the  machine-specific  representation of the saved context, that includes  the  calling  thread machine registers.</span></span><br><span class="line">           <span class="keyword">mcontext_t</span>        uc_mcontext;</span><br><span class="line">           ...</span><br><span class="line">        &#125; <span class="keyword">ucontext_t</span>;</span><br></pre></td></tr></table></figure></p>
<h2 id="getcontext"><a href="#getcontext" class="headerlink" title="getcontext"></a>getcontext</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//get the user context</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getcontext</span><span class="params">(<span class="keyword">ucontext_t</span> *ucp)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">   -ucp: the <span class="keyword">ucontext_t</span> type, points to the context.</span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">   seccessed: <span class="number">0</span></span><br><span class="line">   error: <span class="number">-1</span> <span class="keyword">and</span> <span class="built_in">set</span> errno appropriately.</span><br></pre></td></tr></table></figure>
<h2 id="setcontext"><a href="#setcontext" class="headerlink" title="setcontext"></a>setcontext</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//set the user context</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">setcontext</span><span class="params">(<span class="keyword">const</span> <span class="keyword">ucontext_t</span> *ucp)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">   -ucp: the <span class="keyword">ucontext_t</span> type, points to the context.</span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">   seccessed: does <span class="keyword">not</span> <span class="keyword">return</span>.</span><br><span class="line">   error: <span class="number">-1</span> <span class="keyword">and</span> <span class="built_in">set</span> errno appropriately.</span><br></pre></td></tr></table></figure>
<h2 id="makecontext"><a href="#makecontext" class="headerlink" title="makecontext"></a>makecontext</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// modifies the context pointed to by ucp</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">makecontext</span><span class="params">(<span class="keyword">ucontext_t</span> *ucp, <span class="keyword">void</span> (*func)(), <span class="keyword">int</span> argc, ...)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -ucp: the context pointer.</span><br><span class="line">    -func: When <span class="keyword">this</span> context is later activated the function func is called, </span><br><span class="line">    -argc: passed the  series  of  integer arguments  that  follow  argc to func; the caller must specify the number of these arguments in argc .</span><br><span class="line"><span class="keyword">return</span>: </span><br><span class="line">    no</span><br></pre></td></tr></table></figure>
<h2 id="swapcontext"><a href="#swapcontext" class="headerlink" title="swapcontext"></a>swapcontext</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//saves the current context in the structure pointed to by oucp, and then activates the context pointed to by ucp.</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">swapcontext</span><span class="params">(<span class="keyword">ucontext_t</span> *oucp, <span class="keyword">const</span> <span class="keyword">ucontext_t</span> *ucp)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -oucp: The swapcontext() function saves the current context in the structure pointed to by oucp.</span><br><span class="line">    -ucp:  the context pointer.</span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    successed: does <span class="keyword">not</span> <span class="keyword">return</span>, (But we may <span class="keyword">return</span> later, in <span class="keyword">case</span> oucp is activated, in which <span class="keyword">case</span>  it  looks  like  swapcontext() returns <span class="number">0.</span>)</span><br><span class="line">    error: <span class="number">-1</span> <span class="keyword">and</span> sets errno appropriately.</span><br></pre></td></tr></table></figure>
<h2 id="code"><a href="#code" class="headerlink" title="code"></a>code</h2><hr>
<p>In this program, we use getcontext() to get the context before print “hello world”, then we use setcontext() to recover the context which we stored. Therefore, this program print “hello world” recurrently.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//using getcontext and setcontext</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ucontext.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span>** argv)</span></span>&#123;</span><br><span class="line">        <span class="keyword">ucontext_t</span> context;</span><br><span class="line"></span><br><span class="line">        getcontext(&amp;context);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"hello world!"</span>&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        sleep(<span class="number">1</span>);</span><br><span class="line">        setcontext(&amp;context);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>result:<br><img src="https://upload-images.jianshu.io/upload_images/13348038-76df75111b70b830.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[1] <a href="https://en.wikipedia.org/wiki/Coroutine#Comparison_with_threads" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Coroutine#Comparison_with_threads</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/15/Fiber-In-Linux/" data-id="cka8b3cit0007okv674gre1vy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-RWLock-In-Linux" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/15/RWLock-In-Linux/" class="article-date">
  <time datetime="2020-05-15T14:28:33.000Z" itemprop="datePublished">2020-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/15/RWLock-In-Linux/">RWLock In Linux</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Mutex Lock blocks all the threads which attempts to enter critical section. However, the enter cirtical section operation can be divided into read data and write data. According to this principle, the lock can be separted as read lock and write lock. The read-write lock requires to obey the following rules:</p>
<ul>
<li>as long as no thread holds any write lock, any threads can get any type (read or write) lock to read.</li>
<li>when and only when no lock is used to write or read, write lock can be allocated and used to write.</li>
</ul>
<p>That is to say, as long as no thread is modifing critical section, any type lock can be used to read. When and only when on any other threads are modifing critical section, write lock is able to write.</p>
<h1 id="header"><a href="#header" class="headerlink" title="header"></a>header</h1><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;pthread.h&gt;</span></span></span><br></pre></td></tr></table></figure>
<h2 id="category"><a href="#category" class="headerlink" title="category"></a>category</h2><p><a href="#pthread_rwlock_t">pthread_rwlock_t</a></p>
<p><a href="#pthread_rwlock_rdlock">pthread_rwlock_rdlock</a></p>
<p><a href="#pthread_rwlock_wrlock">pthread_rwlock_wrlock</a></p>
<p><a href="#pthread_rwlock_unlock">pthread_rwlock_unlock</a></p>
<p><a href="#pthread_rwlock_trywrlock">pthread_rwlock_tryrdlock</a></p>
<p><a href="#pthread_rwlock_trywrlock">pthread_rwlock_trywrlock</a></p>
<p><a href="pthread_rwlock_destroy">pthread_rwlock_destroy</a></p>
<p><a href="#pthread_rwlockattr_init">pthread_rwlockattr_init</a></p>
<p><a href="pthread_rwlockattr_destroy">pthread_rwlockattr_destroy</a></p>
<p><a href="pthread_rwlockattr_getpshared">pthread_rwlockattr_getpshared</a></p>
<p><a href="pthread_rwlockattr_setpshared">pthread_rwlockattr_setpshared</a></p>
<h2 id="pthread-rwlock-t"><a href="#pthread-rwlock-t" class="headerlink" title="pthread_rwlock_t"></a>pthread_rwlock_t</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//The defination of pthread_rwlock_t</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    <span class="keyword">pthread_mutex_t</span> rw_mutex;   <span class="comment">/*basic lock on this struct*/</span></span><br><span class="line">    <span class="keyword">pthread_cond_t</span> rw_condreaders;  <span class="comment">/*for reader threads waiting*/</span></span><br><span class="line">    <span class="keyword">pthread_cond_t</span> rw_condwriters;  <span class="comment">/*for writer threads waiting*/</span></span><br><span class="line">    <span class="keyword">int</span> rw_magic;   <span class="comment">/*for error checking*/</span></span><br><span class="line">    <span class="keyword">int</span> rw_nwaitreaders;    <span class="comment">/*the number waiting*/</span></span><br><span class="line">    <span class="keyword">int</span> rw_nwaitwriters;    <span class="comment">/*the number waiting*/</span></span><br><span class="line">    <span class="keyword">int</span> rw_refcount;    <span class="comment">/*-1 if writer has the lock, else readers holding the lock*/</span></span><br><span class="line">&#125;<span class="keyword">pthread_rwlock_t</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PTHREAD_RWLOCK_INITIALIZER&#123;</span></span><br><span class="line">    PTHREAD_LOCK_INITIALIZER,</span><br><span class="line">    PTHREAD_COND_INITIALIZER,</span><br><span class="line">    PTHREAD_COND_INITIALIZER,</span><br><span class="line">    RW_MAGIC,</span><br><span class="line">    <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="pthread-rwlock-rdlock"><a href="#pthread-rwlock-rdlock" class="headerlink" title="pthread_rwlock_rdlock"></a>pthread_rwlock_rdlock</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//get a read lock, if the lock hold by other thread, blocking and waiting for unlocking.</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_rwlock_rdlock</span><span class="params">(<span class="keyword">pthread_rwlock_t</span> *rwptr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -rwptr: the read-write lock</span><br><span class="line">    </span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    seccessed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure>
<h2 id="pthread-rwlock-wrlock"><a href="#pthread-rwlock-wrlock" class="headerlink" title="pthread_rwlock_wrlock"></a>pthread_rwlock_wrlock</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//get a write lock, if lock is got by other threads, blocking and waiting for unlocking.</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_rwlock_wrlock</span><span class="params">(<span class="keyword">pthread_rwlock_t</span> *rwptr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -rwptr: the read-write lock</span><br><span class="line">    </span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    seccessed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure>
<h2 id="pthread-rwlock-unlock"><a href="#pthread-rwlock-unlock" class="headerlink" title="pthread_rwlock_unlock"></a>pthread_rwlock_unlock</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//release a read-wirte lock</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_rwlock_unlock</span><span class="params">(<span class="keyword">pthread_rwlock_t</span> *rwptr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -rwptr: the read-write lock</span><br><span class="line">    </span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    seccessed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure>
<h2 id="pthread-rwlock-tryrdlock"><a href="#pthread-rwlock-tryrdlock" class="headerlink" title="pthread_rwlock_tryrdlock"></a>pthread_rwlock_tryrdlock</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//gets a read lock, if the lock hold by other thread, return a EXXX without blocking</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_rwlock_tryrdlock</span><span class="params">(<span class="keyword">pthread_rwlock_t</span> *rwptr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -rwptr: the read-write lock</span><br><span class="line">    </span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    seccessed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure>
<h2 id="pthread-rwlock-trywrite"><a href="#pthread-rwlock-trywrite" class="headerlink" title="pthread_rwlock_trywrite"></a>pthread_rwlock_trywrite</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//gets a write lock, if the lock hold by other thread, return a EXXX without blocking</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_rwlock_trywrlock</span><span class="params">(<span class="keyword">pthread_rwlock_t</span> *rwptr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -rwptr: the read-write lock</span><br><span class="line">    </span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    seccessed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure>
<h2 id="pthread-rwlock-init"><a href="#pthread-rwlock-init" class="headerlink" title="pthread_rwlock_init"></a>pthread_rwlock_init</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//initializes a read-write lock</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_rwlock_init</span><span class="params">(<span class="keyword">pthread_rwlock_t</span> *rwptr,<span class="keyword">const</span> <span class="keyword">pthread_rwlockattr_t</span> *attr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -rwptr: the read-write lock</span><br><span class="line">    -attr: the attribute</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    seccessed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure>
<h2 id="pthread-rwlock-destroy"><a href="#pthread-rwlock-destroy" class="headerlink" title="pthread_rwlock_destroy"></a>pthread_rwlock_destroy</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//destroy a read-write lock</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_rwlock_destroy</span><span class="params">(<span class="keyword">pthread_rwlock_t</span> *rwptr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -rwptr: the read-write lock</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    seccessed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure>
<h2 id="pthread-rwlockattr-init"><a href="#pthread-rwlockattr-init" class="headerlink" title="pthread_rwlockattr_init"></a>pthread_rwlockattr_init</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//set a pthread_rwlockattr_t</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_rwlockattr_init</span><span class="params">(<span class="keyword">pthread_rwlock_t</span> *attr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -attr: the attribute</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    seccessed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure>
<h2 id="pthread-rwlockattr-destroy"><a href="#pthread-rwlockattr-destroy" class="headerlink" title="pthread_rwlockattr_destroy"></a>pthread_rwlockattr_destroy</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//destroy a pthread_rwlockattr_t</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_rwlockattr_destroy</span><span class="params">(<span class="keyword">pthread_rwlock_t</span> *attr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -attr: the attribute</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    seccessed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure>
<h2 id="pthread-rwlockattr-getpshared"><a href="#pthread-rwlockattr-getpshared" class="headerlink" title="pthread_rwlockattr_getpshared"></a>pthread_rwlockattr_getpshared</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_rwlockattr_getpshared</span><span class="params">(<span class="keyword">pthread_rwlock_t</span> *attr,<span class="keyword">int</span> *valptr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -attr: the attribute</span><br><span class="line">    -valptr: the attribute value</span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    seccessed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure>
<h2 id="pthread-rwlockattr-setpshared"><a href="#pthread-rwlockattr-setpshared" class="headerlink" title="pthread_rwlockattr_setpshared"></a>pthread_rwlockattr_setpshared</h2><hr>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_rwlockattr_setpshared</span><span class="params">(<span class="keyword">pthread_rwlock_t</span> *attr,<span class="keyword">int</span> *valptr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -attr: the attribute</span><br><span class="line">    -valptr: the attribute value</span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    seccessed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/15/RWLock-In-Linux/" data-id="cka8b3civ000bokv6dartgzi7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Mutex-In-Linux" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/15/Mutex-In-Linux/" class="article-date">
  <time datetime="2020-05-15T14:27:58.000Z" itemprop="datePublished">2020-05-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/15/Mutex-In-Linux/">Mutex In Linux</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="header"><a href="#header" class="headerlink" title="header"></a>header</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;thread.h&gt;</span><br></pre></td></tr></table></figure>
<h2 id="category"><a href="#category" class="headerlink" title="category"></a>category</h2><hr>
<p><a href="#pthread_mutex_t">pthread_mutex_t</a></p>
<p><a href="#pthread_mutex_lock">pthread_mutex_lock</a></p>
<p><a href="#pthread_mutex_trylock">pthread_mutex_trylock</a></p>
<p><a href="pthread_mutex_init">pthread_muext_init</a></p>
<p><a href="#pthread_mutex_unlock">pthread_mutex_unlock</a></p>
<p><a href="#pthread_mutex_destroy">pthread_mutex_destroy</a></p>
<h2 id="pthread-mutex-t"><a href="#pthread-mutex-t" class="headerlink" title="pthread_mutex_t"></a>pthread_mutex_t</h2><p>The pthread_mutex_t is a mutex data type, which can be initialized by two methods.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// if pthread_mutex_t is declared as a static variable</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">pthread_mutex_t</span> lock=PTHREAD_MUTEX_INITILIZER;</span><br><span class="line"></span><br><span class="line"><span class="comment">// if pthread_mutex_t is declared as a dynamic variable</span></span><br><span class="line"><span class="keyword">pthread_mutex_t</span>* lock;</span><br><span class="line">pthread_mutex_init(lock);</span><br></pre></td></tr></table></figure></p>
<h2 id="pthread-mutex-lock"><a href="#pthread-mutex-lock" class="headerlink" title="pthread_mutex_lock"></a>pthread_mutex_lock</h2><p>Try to lock a mutex, if the mutex is locked, blocking and waiting for until it is unlock.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//lock a mutex variable</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_mutex_lock</span><span class="params">(<span class="keyword">pthread_mutex_t</span> *mptr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -mptr: a pointer of mutex.</span><br><span class="line"><span class="keyword">return</span>: </span><br><span class="line">    successed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure></p>
<h2 id="pthread-mutex-trylock"><a href="#pthread-mutex-trylock" class="headerlink" title="pthread_mutex_trylock"></a>pthread_mutex_trylock</h2><p>Try to lock a mutex, if it is locked, return a EBUSY.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_mutex_trylock</span><span class="params">(<span class="keyword">pthread_mutex_t</span> *mptr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -mptr: a pointer of mutex.</span><br><span class="line"><span class="keyword">return</span>: </span><br><span class="line">    successed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure></p>
<h2 id="pthread-mutex-unlock"><a href="#pthread-mutex-unlock" class="headerlink" title="pthread_mutex_unlock"></a>pthread_mutex_unlock</h2><p>unlock a mutex, if it is unlock, blocking and waitting.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_mutex_unlock</span><span class="params">(<span class="keyword">pthread_mutex_t</span> *mptr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -mptr: a pointer of mutex</span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    successed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure></p>
<h2 id="pthread-mutex-destroy"><a href="#pthread-mutex-destroy" class="headerlink" title="pthread_mutex_destroy"></a>pthread_mutex_destroy</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_mutex_init</span><span class="params">(<span class="keyword">pthread_mutex_t</span> *mutex,<span class="keyword">const</span> <span class="keyword">pthread_mutexattr_t</span> attr)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -mutex: the mutex type</span><br><span class="line">    -attr: attribute of mutex</span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    successed: <span class="number">0</span></span><br><span class="line">    error: Exxx</span><br></pre></td></tr></table></figure>
<h2 id="pthread-mutex-init"><a href="#pthread-mutex-init" class="headerlink" title="pthread_mutex_init"></a>pthread_mutex_init</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pthread_mutex_destroy</span><span class="params">(<span class="keyword">pthread_mutex_t</span>* mutex)</span></span>;</span><br><span class="line"></span><br><span class="line">args:</span><br><span class="line">    -mutex: the mutex type</span><br><span class="line"><span class="keyword">return</span>:</span><br><span class="line">    successed: <span class="number">0</span></span><br><span class="line">    error: EXXX</span><br></pre></td></tr></table></figure>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code:"></a>Code:</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//consumer and producer model</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shared</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">pthread_mutex_t</span> lock;</span><br><span class="line">        <span class="keyword">static</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="built_in">array</span>;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">int</span> nmax;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">int</span> ncur;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">int</span> nval;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">pthread_mutex_t</span> Shared::lock=PTHREAD_MUTEX_INITIALIZER;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Shared::<span class="built_in">array</span>;</span><br><span class="line"><span class="keyword">int</span> Shared::nmax=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> Shared::ncur=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> Shared::nval=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span>* <span class="title">producer</span><span class="params">(<span class="keyword">void</span>* arg)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">                pthread_mutex_lock(&amp;Shared::lock);</span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"thread ["</span>&lt;&lt;pthread_self()&lt;&lt;<span class="string">"] is writing value: "</span>&lt;&lt;Shared::nval&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">                <span class="keyword">if</span>(Shared::ncur&gt;=Shared::nmax)&#123;</span><br><span class="line">                        pthread_mutex_unlock(&amp;Shared::lock);</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                Shared::<span class="built_in">array</span>.push_back(Shared::nval);</span><br><span class="line">                Shared::ncur++;</span><br><span class="line">                Shared::nval++;</span><br><span class="line">                pthread_mutex_unlock(&amp;Shared::lock);</span><br><span class="line">                sleep(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span>* <span class="title">consumer</span><span class="params">(<span class="keyword">void</span>* arg)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;Shared::<span class="built_in">array</span>.size();++i)&#123;</span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"consume value: "</span>&lt;&lt;Shared::<span class="built_in">array</span>[i]&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span>** argv)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(argc!=<span class="number">3</span>)&#123;</span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"arguments number error"</span>&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> nmax=atoi(argv[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">int</span> nthreads=atoi(argv[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">pthread_t</span>&gt; <span class="title">producer_tids</span><span class="params">(nthreads)</span></span>;</span><br><span class="line">        <span class="keyword">pthread_t</span> consumer_tid;</span><br><span class="line">        Shared::nmax=nmax;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nthreads;++i)&#123;</span><br><span class="line">                <span class="keyword">if</span>(pthread_create(&amp;producer_tids[i],<span class="literal">nullptr</span>,producer,<span class="literal">nullptr</span>))&#123;</span><br><span class="line">                        <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"pthread_create error"</span>&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nthreads;++i)&#123;</span><br><span class="line">                <span class="keyword">if</span>(pthread_join(producer_tids[i],<span class="literal">nullptr</span>))&#123;</span><br><span class="line">                        <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"pthread_join error"</span>&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"thread "</span>&lt;&lt;i&lt;&lt;<span class="string">" Done!"</span>&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(pthread_create(&amp;consumer_tid,<span class="literal">nullptr</span>,consumer,<span class="literal">nullptr</span>))&#123;</span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"pthread_create error"</span>&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(pthread_join(consumer_tid,<span class="literal">nullptr</span>))&#123;</span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"pthread_join error"</span>&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">"Main Function Done!"</span>&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/15/Mutex-In-Linux/" data-id="cka8b3ciw000fokv684wr3rsr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-Structure/" rel="tag">Data Structure</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Introduce-To-Algorithm/" rel="tag">Introduce To Algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network/" rel="tag">network</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/C/" style="font-size: 13.33px;">C++</a> <a href="/tags/Data-Structure/" style="font-size: 13.33px;">Data Structure</a> <a href="/tags/Introduce-To-Algorithm/" style="font-size: 16.67px;">Introduce To Algorithm</a> <a href="/tags/Linux/" style="font-size: 20px;">Linux</a> <a href="/tags/network/" style="font-size: 10px;">network</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/05/15/What-Compile-Do-When-An-Empty-Class-Is-Declared/">What Compile Do When An Empty Class Is Declared</a>
          </li>
        
          <li>
            <a href="/2020/05/15/Throw-Exception-In-Constructor-And-Destructor/">Throw Exception In Constructor And Destructor</a>
          </li>
        
          <li>
            <a href="/2020/05/15/bind-And-function-In-C/">bind And function In C++</a>
          </li>
        
          <li>
            <a href="/2020/05/15/Variable-Arguments-In-C/">Variable Arguments In C++</a>
          </li>
        
          <li>
            <a href="/2020/05/15/Install-Boost-In-Linux/">Install Boost In Linux</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 BeeCaffe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>